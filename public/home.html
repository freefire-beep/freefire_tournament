<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Nexus - Home</title>
    <link rel="stylesheet" href="style.css">
</head>
<body style="background-color: #0d1117; color: white; margin: 0; padding-bottom: 70px;">

    <div style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #30363d;">
        <h3 style="color: #58a6ff; margin: 0;">ELITE NEXUS</h3>
        <div style="background: #161b22; padding: 5px 12px; border-radius: 20px; border: 1px solid #58a6ff;">
            <span id="userCoins">0</span> ü™ô
        </div>
    </div>

    <div id="packageContainer" style="padding: 15px;">
        </div>

    <div style="position: fixed; bottom: 0; width: 100%; background: #161b22; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #30363d;">
        <button onclick="location.href='inbox.html'" style="background:none; border:none; color:gray; cursor:pointer;">üìß Inbox</button>
        <button onclick="location.href='home.html'" style="background:none; border:none; color:#58a6ff; cursor:pointer;">üè† Home</button>
        <button onclick="location.href='account.html'" style="background:none; border:none; color:gray; cursor:pointer;">üë§ Account</button>
    </div>

    <script>
        // ‡¶≤‡¶ó‡¶á‡¶® ‡¶ö‡ßá‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
        const user = JSON.parse(sessionStorage.getItem('user'));
        if(!user) location.href = 'index.html';

        document.getElementById('userCoins').innerText = user.coins;

        // ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶°‡¶æ‡¶ü‡¶æ (‡¶è‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶á‡¶≤‡ßá API ‡¶•‡ßá‡¶ï‡ßá‡¶ì ‡¶Ü‡¶®‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®)
        const packages = [
            { id: "p1", title: "Solo ‚Ä¢ Rapid Match", fee: 5 },
            { id: "p2", title: "Solo ‚Ä¢ Ranked Clash", fee: 10 },
            { id: "p3", title: "Duo ‚Ä¢ Tactical", fee: 20 },
            { id: "p4", title: "Squad ‚Ä¢ Battle", fee: 30 },
            { id: "p5", title: "Mega Tournament", fee: 50 }
        ];

        const container = document.getElementById('packageContainer');
        packages.forEach(pkg => {
            container.innerHTML += `
                <div style="background:#161b22; padding:15px; border-radius:10px; margin-bottom:15px; display:flex; justify-content:space-between; align-items:center; border:1px solid #30363d;">
                    <div>
                        <h4 style="margin:0;">‡ß≥ ${pkg.fee}</h4>
                        <small style="color:gray;">${pkg.title}</small>
                    </div>
                    <button onclick="buyPackage('${pkg.id}', ${pkg.fee}, '${pkg.title}')" style="background:linear-gradient(to right, #00d2ff, #3a7bd5); color:white; border:none; padding:8px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">Join</button>
                </div>
            `;
        });

        async function buyPackage(id, fee, title) {
            if(!confirm(`‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ${fee} ‡¶ï‡ßü‡ßá‡¶® ‡¶¶‡¶ø‡ßü‡ßá ${title} ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡¶ü‡¶ø ‡¶ï‡¶ø‡¶®‡¶§‡ßá ‡¶ö‡¶æ‡¶®?`)) return;

            try {
                const response = await fetch('/api/purchase', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ gameId: user.gameId, fee, packageName: title, userName: user.name })
                });

                const data = await response.json();
                if(response.ok) {
                    alert("‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡ßá‡¶®‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                    user.coins -= fee; // ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                    sessionStorage.setItem('user', JSON.stringify(user));
                    location.reload();
                } else {
                    alert(data.message);
                }
            } catch (err) {
                alert("‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            }
        }
    </script>
</body>
  </html>
  
